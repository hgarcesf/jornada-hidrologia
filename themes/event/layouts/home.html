{{- define "main" }}
    {{- partial "sections/event-title.html"
        (dict
        "title" .Site.Params.themes.event.title
        "location" .Site.Params.themes.event.location
        "startDate" .Site.Params.themes.event.startDate
        "backgroundImage" .Site.Params.themes.event.images.titleBackground
        "eventbriteId" .Site.Params.themes.event.callToAction.eventbrite.eventId
        "ctaUrl" .Site.Params.themes.event.callToAction.other.url
        )
    }}

    {{ partial "sections/event-highlights.html" (
        dict
        "title" .Site.Params.themes.event.auxTitle
        "subtitle" .Site.Params.themes.event.auxSlogan
        "description" .Site.Params.themes.event.auxDescription
        "logo" .Site.Params.themes.event.images.logo)
    }}

    {{ $eventStartDate := or .Site.Params.themes.event.startDate now | time }}
    {{ $eventEndDate := or .Site.Params.themes.event.endDate now | time }}
    {{ $dayInSeconds := 86400 }}
    {{ partial "sections/event-highlights.html" (
        dict
        "title" .Site.Params.themes.event.title
        "subtitle" .Site.Params.themes.event.slogan
        "description" .Site.Params.themes.event.description
        "logo" .Site.Params.themes.event.images.logo
        "numberOfSessions" 4
        "numberOfDays" 3
        "location" "UFRO, Campus Pucón" )
    }}


    {{/* --- inicio afiche --- */}}
    {{- $posterPath := "images/Afiche_Jornada_Hidrologia_web.png" -}}
    {{- $posterAlt  := "Afiche de la Jornada de Hidrología" -}}

    {{- $poster := resources.Get $posterPath -}}
    {{- if $poster }}
      {{- $p480  := $poster.Resize "480x webp" -}}
      {{- $p960  := $poster.Resize "960x webp" -}}
      {{- $p1440 := $poster.Resize "1440x webp" -}}

      <div style="width:100%; text-align:center; margin: 2.5rem 0;">
        <picture>
          <source type="image/webp"
                  srcset="{{ $p480.RelPermalink }} 480w,
                          {{ $p960.RelPermalink }} 960w,
                          {{ $p1440.RelPermalink }} 1440w"
                  sizes="(max-width: 768px) 90vw, (max-width: 1200px) 70vw, 700px">
          <img src="{{ $p960.RelPermalink }}"
               alt="{{ $posterAlt }}"
               loading="lazy"
               decoding="async"
               style="display:block; margin:0 auto;
                      max-width:700px; width:100%; height:auto;
                      border-radius:10px;
                      box-shadow:0 4px 14px rgba(0,0,0,0.15);">
        </picture>
      </div>
    {{- end }}
    {{/* --- fin afiche --- */}}



<!--
    {{- $tracks := slice }}
    {{- range (.Site.RegularPages.GroupByParam "track") }}
        {{- $tracks = $tracks | append (.Key) }}
    {{- end }}

    {{- if gt ($tracks | len) 1 }}
        {{- partial "sections/conference-tracks.html" (
            dict
            "tracks" $tracks
            "sessionsUrl" (.Site.GetPage "sessions").RelPermalink
            )
        }}
    {{- end }}

    {{- $topSpeakers := slice }}
    {{- range (where .Site.Pages "Section" "speakers") }}
        {{- if .Params.isTopSpeaker }}
            {{- $topSpeakers = $topSpeakers | append (
                dict
                "profileUrl" .RelPermalink
                "avatarResource" (.Resources.GetMatch "avatar.*")
                "name" .Title
                "description" .Params.tagLine
                "linkedinUrl" .Params.linkedinUrl
                "xUrl" .Params.xUrl
                "companyUrl" .Params.company
                )
            }}
        {{- end }}
    {{- end }}

    {{- if gt ($topSpeakers | len) 0 }}
        {{ partial "sections/featured-speakers.html" (
            dict
            "speakers" $topSpeakers
            "speakersUrl" (.Site.GetPage "speakers").RelPermalink
            )
        }}
    {{- end }}-->


    {{- $featuredSessions := slice }}
    {{- range (where .Site.Pages "Section" "sessions") }}
        {{- if (in .Site.Params.themes.event.featuredSessions .Params.sessionId) }}
            {{- $featuredSessionPage := . }}
            {{- $featuredSessionSpeakers := slice }}
            {{- range .Params.speakers }}
                {{- $speaker :=  . }}
                {{- $featuredSessionSpeakers = $featuredSessionSpeakers | append (
                    dict
                    "avatarResource" ($featuredSessionPage.Resources.GetMatch (printf "avatar-%s.*" $speaker.id))
                    "name" $speaker.fullName
                    "slogan" $speaker.tagLine
                    )
                }}
            {{- end }}
            {{- $featuredSessions = $featuredSessions | append (
                dict
                "sessionUrl" $featuredSessionPage.RelPermalink
                "sessionName" $featuredSessionPage.Title
                "sessionDescription" $featuredSessionPage.RawContent
                "speakers" $featuredSessionSpeakers
                "categories" $featuredSessionPage.Params.categories
                )
            }}
        {{- end }}
    {{- end }}

    {{- if gt ($featuredSessions | len) 0 }}
        {{ partial "sections/featured-sessions.html" (
            dict
            "sessions" $featuredSessions
            "sessionsUrl" (.Site.GetPage "sessions").RelPermalink
            )
        }}
    {{- end }}
    {{ partial "sections/our-sponsors.html" (dict
      "sponsors" .Site.Params.themes.event.sponsors
      "kind"     "sponsors"
    ) }}

    {{ partial "sections/our-sponsors.html" (dict
      "sponsors" .Site.Params.themes.event.partners
      "kind"     "partners"
    ) }}

    {{ partial "sections/our-sponsors.html" (dict
      "sponsors" .Site.Params.themes.event.organizers
      "kind"     "organizers"
    ) }}

    {{ partial "sections/pucon-highlights.html" (
        dict
        "title" "Sobre Pucón"
        "subtitle" "Atractivos del entorno"
        "description" .Site.Params.themes.event.locationDescription
        "logo" .Site.Params.themes.event.images.locationImg
        "numberOfSessions" "Atractivos naturales"
        "numberOfDays" "Reservas nacionales"
        "location" "Vida nocturna" )
    }}


{{- end }}
